# Implementation Guide (Video)
![](https://github.com/openinfer/PrivateIdentity/blob/master/images/Single%20Compoent%20App%20PLAY%201.png)
> Discuss how the client app makes user enrollment and prediction (authentication) fast and easy (with no software to deploy and no hardware to buy)

> show how to embed the DIV and get up and running in 30 seconds.

> Next, show how to make the client app perform to exact specifications using URL parameters

> Show how to enroll a second or third biometric modality for an existing user



# Overview - Single Component JavaScript app
![](https://github.com/openinfer/PrivateIdentity/blob/master/images/Single%20Compoent%20App%202.png)

* Preserves privacy by synchronously acquiring and FHE transforming biometric data at the edge
* Easy to deploy with no requirement to install additional software, plugins or extensions
* Built with Javascript, TensorFlow.js and an ensemble of helper DNNs
* Works on commodity devices without sacrificing performance 
* Runs on 90% of all modern devices

This Web client authenticates an unlimited number of online users by transmitting FHE payloads to a server, private or public cloud. Identity returns in 300ms. In “off-line mode,” where a network is not present, the client authenticates a maximum of 50 offline users on a modern phone and a few thousand offline users on a laptop. Offline authentication is limited by system resources and returns identity in <10ms. 

Multiple biometric modalities are provided for high risk applications that may require additional biometric authentication mechanisms for step-up authentication. This provides system administrators with the flexibility of requiring a single convenient biometric authentication modality for low-risk applications or more rigorous authentication as needed. The fingerprint biometric modality is recommended to handle difficult cases such as identical twins.

The Web client provides automated visual guidance during prediction and enrollment to assist unsupervised and supervised users in acquiring quality biometrics. The system creates an enrollment package 50 FHE payloads to bind the trusted user identifier (a UUID generated by the system) with the authorized user’s private biometric identity. After enrollment, the Cloud Biometric MFA system may store the enrollment package in the secure element of the user’s device to support offline authentication and/or on a server, within the Cloud Biometric MFA system (i.e. GCP Storage and GCP Memorystore).

The Cloud Biometric MFA system’s prediction capability uses a payload of 3 FHE vectors and returns the UUID of an identity or -1 if not found.

## Architecture Discussion
![Logical Boundaries Diagram for Single Component Web app](https://github.com/openinfer/PrivateIdentity/blob/master/images/Single%20Compoent%20App%20Logic%20Boundaries%201.png)
> Single Component Web app - Logical Block Diagram

The Web app uses fully homomorphic encryption (FHE) methods to ensure privacy, security and confidentiality of the prediction and enrollment packages. To accomplish this, the Web app acquires biometrics using a set of helper DNNs and one pre-trained mobile embedding DNN per biometric modality. These DNNs acquire the biometric using a biometric acquisition workflow and then discard (delete) the plaintext biometric after embedding creation.

The biometric acquisition workflow is implemented as follows. 
* [**Biometric Capture.**](https://github.com/openinfer/PrivateIdentity/wiki/Client-Applications#Web-applications)  The sensor (e.g. phone camera, Webcam, microphone, etc.) acquires a sample of the user’s biometric. 
* [**Geometry DNN**](https://github.com/openinfer/PrivateIdentity/wiki/Biometric-Ingestion-and-Helper-DNNs#face-and-face-wmask-geometry-detection-dnn) - The Geometry DNN determines the (x,y) coordinates of the biometric. 
* [**Validation DNN**](https://github.com/openinfer/PrivateIdentity/wiki/Biometric-Ingestion-and-Helper-DNNs#4-classes-good-blurry-eyeglasses-facemask-validation-dnn) - Validation DNN provides real-time user guidance for acquiring quality biometrics and validates the biometric sample and determines liveness (anti-spoofing).  
* [**Embedding DNN**](https://github.com/openinfer/PrivateIdentity/wiki/Biometric-Ingestion-and-Helper-DNNs#face-facemask-and-fingerprint-embedding-dnns) – The Embedding DNN transforms the validated biometric sample into an encrypted payload (“FHE payload”). 
* **Delete Biometric** – The system then discards (deletes) the original biometric data to eliminate risk of loss and prevent any possible future linkage. 

## Hardware, Browser and Platform Requirements
> list minimum device requirements 

> list minimum browser requirements

> List minimum Android, iOS requirements

> List minimum camera and microphone requirements

> List minimum processor requirements 

## URL Parameters 
URL parameters are used to control all functions of the Web client. The Web client conforms to the [W3C Usage Patterns For Client-Side URL parameters](https://www.w3.org/2001/tag/doc/hash-in-url-20080211.html).  Common URL parameters are listed below.

An URL parameter example is as follows:  
> https://private.id/demo/?apiKey=1962&debug=true

| **Common URL Parameters*** | Possible values | Default Value | Function | 
|-----|----|---|-----|
|action|predict / enroll|No default|Prediction only Default:face can be combined with voice: Enroll with face by default, can be combined with voice|
|antiVideoSpoof|true / false|false|Video spoofing|
|apiKey| Value of apiKey|No default|Set apiKey for requests to execute|
|faceMask|true / false|true|Use face mask embedding model.|
|face| true / false|true|Enroll & predict with face|
|fingerPrint|true / false|false|Prediction using Fingerprint (In Progress)|
|voice|true / false|false|Enroll & Predict with voice|
|glassCheck|true / false|false|Turn glasses check on predict/enroll to on/off|
|idp|okta / ping / azure/ gsuite|null|Set SAML destination|
|antiVideoSpoof|true / false|false|Check the webcam capture is a spoofed one or not.

* The full list of Web Client URL parameters is found [here.](https://github.com/openinfer/PrivateIdentity/wiki/Client-URL-Parameters)
* The full list of Administrative URL parameters is found [here.](https://github.com/openinfer/PrivateIdentity/wiki/Admin-URL-Parameters)

### API Key Security
> Discuss using the API key as  URL parameter and also how to conceal the API key in the encrypted payload.

### Enrollment
> Discuss URL parameters to use for enroll. 

> Discuss the benefits and drawbacks of turning the eyeglass check on or off

> turning antiSpoofing on or off, 

> Turning eye blink on or off

> Discuss URL parameters to enroll multiple biometrics at the same time.

> Discuss URL parameters to add a biometric enrollment to an existing subject ID

Discuss the workflow that is followed for enrollment.
1. Capture user's biometrics using built-in sensors, Webcams, USB microphones, etc. Captures 10 for enrollment and 3 for prediction.
1. Validate Biometrics. If any of the images are not suitable for training, a message is returned and the image is removed. The user must add more images until at least 10 images meeting the minimum quality standards have been provided.
1. FHE Transform Biometrics
1. Delete Biometrics
1. Server validates FHE enrollment package
1.  Server attempts to match enrollment to existing user. If existing user is matched, server returns UUID without enrolling subject
1. If no match is found, the system extracts the features from the images and stores the features in the system.

### Enrollment Consent Forms

> show first form

> show second form

> discuss how to customize the message as needed.

### Voice Enroll and Predict
1. The user is asked to read a specific sentence.
1. The user's voice is captured
1. Speech to text determines if user's voice said the required words
1. The voice is FHE transformed and the server attempts to predict or enroll
1. A UUID is returned or a -1 is returned to indicate no match. 

### Fingerprint Enroll
1. Fingerprint obtained using  at least 1MP camera (720P) on phone or Webcam ("optical scan") or capacitive scan
1. Geometry DNN 
1. Validation DNN - crop & align
1. Embedding DNN - FHE transform 
1. Delete Biometric
1. Transmit FHE payload to server
1. Server returns UUID or -1 (no match)

## Code Samples
> Give the user a head start on implementation - help make this as easy as possible.
  